# <a name="get-access-on-behalf-of-a-user"></a><span data-ttu-id="8ce04-101">Obtener acceso en nombre de un usuario</span><span class="sxs-lookup"><span data-stu-id="8ce04-101">Get access on behalf of a user</span></span>
<span data-ttu-id="8ce04-p101">Para usar Microsoft Graph para leer y escribir recursos en nombre de un usuario, la aplicación debe obtener un token de acceso de Azure AD y adjuntarlo a las solicitudes que envía a Microsoft Graph. El flujo de autenticación exacto que se use para obtener tokens de acceso dependerá de la clase de aplicación que se esté desarrollando y de si se quiere usar OpenID Connect para iniciar la sesión del usuario en la aplicación. Un flujo habitual que usan las aplicaciones nativas y móviles y también algunas aplicaciones web es el flujo de concesión del código de autorización de OAuth 2.0. En este tema, veremos un ejemplo del uso de este flujo.</span><span class="sxs-lookup"><span data-stu-id="8ce04-p101">To use Microsoft Graph to read and write resources on behalf of a user, your app must get an access token from Azure AD and attach the token to requests that it sends to Microsoft Graph. The exact authentication flow that you will use to get access tokens will depend on the kind of app you are developing and whether you want to use OpenID Connect to sign the user in to your app. One common flow used by native and mobile apps and also by some Web apps is the OAuth 2.0 authorization code grant flow. In this topic, we will walk through an example using this flow.</span></span> 

## <a name="authentication-and-authorization-steps"></a><span data-ttu-id="8ce04-106">Pasos de autenticación y autorización</span><span class="sxs-lookup"><span data-stu-id="8ce04-106">Authentication and Authorization steps</span></span>

<span data-ttu-id="8ce04-107">Los pasos básicos necesarios para usar el flujo de concesión del código de autorización de OAuth 2.0 para obtener un token de acceso del punto de conexión de Azure AD v2.0 son los siguientes:</span><span class="sxs-lookup"><span data-stu-id="8ce04-107">The basic steps required to use the OAuth 2.0 authorization code grant flow to get an access token from the Azure AD v2.0 endpoint are:</span></span>

1. <span data-ttu-id="8ce04-108">Registrar la aplicación con Azure AD.</span><span class="sxs-lookup"><span data-stu-id="8ce04-108">Register your app with Azure AD.</span></span> 
2. <span data-ttu-id="8ce04-109">Obtener autorización.</span><span class="sxs-lookup"><span data-stu-id="8ce04-109">Get authorization.</span></span> 
3. <span data-ttu-id="8ce04-110">Obtener un token de acceso.</span><span class="sxs-lookup"><span data-stu-id="8ce04-110">Get an access token.</span></span>
4. <span data-ttu-id="8ce04-111">Llamar a Microsoft Graph con el token de acceso.</span><span class="sxs-lookup"><span data-stu-id="8ce04-111">Call Microsoft Graph with the access token.</span></span>
5. <span data-ttu-id="8ce04-112">Usar un token de actualización para obtener un nuevo token de acceso.</span><span class="sxs-lookup"><span data-stu-id="8ce04-112">Use a refresh token to get a new access token.</span></span>

## <a name="1-register-your-app"></a><span data-ttu-id="8ce04-113">1. Registrar la aplicación</span><span class="sxs-lookup"><span data-stu-id="8ce04-113">1. Register your app</span></span>
<span data-ttu-id="8ce04-p102">Para usar el punto de conexión de Azure v2.0, debe registrar la aplicación en el [Portal de registro de aplicaciones de Microsoft](https://apps.dev.microsoft.com/). Puede usar una cuenta de Microsoft o una cuenta profesional o educativa para registrar una aplicación.</span><span class="sxs-lookup"><span data-stu-id="8ce04-p102">To use the Azure v2.0 endpoint, you must register your app at the [Microsoft App Registration Portal](https://apps.dev.microsoft.com/). You can use either a Microsoft account or a work or school account to register an app.</span></span> 

<span data-ttu-id="8ce04-p103">En la captura de pantalla siguiente se muestra un ejemplo del registro de una aplicación web. ![Registro de aplicación web con contraseña y concesión implícita.](./images/v2-web-registration.png)</span><span class="sxs-lookup"><span data-stu-id="8ce04-p103">The following screenshot shows an example Web app registration. ![Web app registration with password and Implicit Grant.](./images/v2-web-registration.png)</span></span>

<span data-ttu-id="8ce04-118">Para configurar una aplicación para que use el flujo de concesión del código de autorización de OAuth 2.0, debe guardar los valores siguientes al registrar la aplicación:</span><span class="sxs-lookup"><span data-stu-id="8ce04-118">To configure an app to use the OAuth 2.0 authorization code grant flow, you'll need to save the following values when registering the app:</span></span>

- <span data-ttu-id="8ce04-119">El id. de aplicación asignado por el portal de registro de aplicaciones.</span><span class="sxs-lookup"><span data-stu-id="8ce04-119">The Application ID assigned by the app registration portal.</span></span>
- <span data-ttu-id="8ce04-p104">Un secreto de la aplicación, ya sea una contraseña o un par de claves pública y privada (certificado). Esto no es necesario para las aplicaciones nativas.</span><span class="sxs-lookup"><span data-stu-id="8ce04-p104">An Application Secret, either a password or a public/private key pair (certificate). This is not required for native apps.</span></span> 
- <span data-ttu-id="8ce04-122">Una dirección URL de redireccionamiento para que la aplicación reciba respuestas de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="8ce04-122">A Redirect URL for your app to receive responses from Azure AD.</span></span>

<span data-ttu-id="8ce04-123">Para conocer los pasos necesarios para configurar una aplicación con el Portal de registro de aplicaciones de Microsoft, vea [Registrar una aplicación](./auth_register_app_v2.md).</span><span class="sxs-lookup"><span data-stu-id="8ce04-123">For steps on how to configure an app using the Microsoft App Registration Portal, see [Register your app](./auth_register_app_v2.md).</span></span>

## <a name="2-get-authorization"></a><span data-ttu-id="8ce04-124">2. Obtener la autorización</span><span class="sxs-lookup"><span data-stu-id="8ce04-124">2. Get authorization</span></span>
<span data-ttu-id="8ce04-p105">El primer paso para obtener un token de acceso para varios flujos de OpenID Connect y OAuth 2.0 consiste en redirigir al usuario al punto de conexión `/authorize` de Azure AD v2.0. Azure AD iniciará la sesión del usuario y obtendrá su consentimiento para los permisos que solicite la aplicación. En el flujo de concesión del código de autorización, después de obtener el consentimiento, Azure AD devolverá un código de autorización a la aplicación que puede canjear en el punto de conexión `/token` de Azure AD v2.0 por un token de acceso.</span><span class="sxs-lookup"><span data-stu-id="8ce04-p105">The first step to getting an access token for many OpenID Connect and OAuth 2.0 flows is to redirect the user to the Azure AD v2.0 `/authorize` endpoint. Azure AD will sign the user in and ensure their consent for the permissions your app requests. In the authorization code grant flow, after consent is obtained, Azure AD will return an authorization_code to your app that it can redeem at the Azure AD v2.0 `/token` endpoint for an access token.</span></span>

### <a name="authorization-request"></a><span data-ttu-id="8ce04-128">Solicitud de autorización</span><span class="sxs-lookup"><span data-stu-id="8ce04-128">Authorization request</span></span> 
<span data-ttu-id="8ce04-129">A continuación se muestra un ejemplo de solicitud al punto de conexión `/authorize`.</span><span class="sxs-lookup"><span data-stu-id="8ce04-129">The following shows an example request to the `/authorize` endpoint.</span></span> 

<span data-ttu-id="8ce04-p106">Con el punto de conexión de Azure AD v2.0, los permisos se solicitan mediante el parámetro `scope`. En este ejemplo, los permisos solicitados de Microsoft Graph son para _User.Read_ y _Mail.Read_, que permitirán que la aplicación lea el perfil y el correo del usuario que ha iniciado sesión. Se solicita el permiso _offline\_access_ para que la aplicación pueda obtener un token de actualización, que puede usar para obtener un nuevo token de acceso cuando expire el actual.</span><span class="sxs-lookup"><span data-stu-id="8ce04-p106">With the Azure AD v2.0 endpoint, permissions are requested using the `scope` parameter. In this example, the Microsoft Graph permissions requested are for _User.Read_ and _Mail.Read_, which will allow the app to read the profile and mail of the signed-in user. The _offline\_access_ permission is requested so that the app can get a refresh token, which it can use to get a new access token when the current one expires.</span></span> 

```
// Line breaks for legibility only

https://login.microsoftonline.com/{tenant}/oauth2/v2.0/authorize?
client_id=6731de76-14a6-49ae-97bc-6eba6914391e
&response_type=code
&redirect_uri=http%3A%2F%2Flocalhost%2Fmyapp%2F
&response_mode=query
&scope=offline_access%20user.read%20mail.read
&state=12345
```
| <span data-ttu-id="8ce04-133">Parámetro</span><span class="sxs-lookup"><span data-stu-id="8ce04-133">Parameter</span></span> |  | <span data-ttu-id="8ce04-134">Descripción</span><span class="sxs-lookup"><span data-stu-id="8ce04-134">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="8ce04-135">tenant</span><span class="sxs-lookup"><span data-stu-id="8ce04-135">tenant</span></span> |<span data-ttu-id="8ce04-136">necesario</span><span class="sxs-lookup"><span data-stu-id="8ce04-136">required</span></span> |<span data-ttu-id="8ce04-p107">Se puede usar el valor `{tenant}` de la ruta de acceso de la solicitud para controlar quién puede iniciar sesión en la aplicación.  Los valores permitidos son `common` para cuentas de Microsoft y cuentas profesionales o educativas, `organizations` solo para cuentas profesionales o educativas, `consumers` solo para cuentas de Microsoft, e identificadores de inquilino como el ID de inquilino o el nombre de dominio.  Para obtener más información, vea los [conceptos básicos de protocolo](https://docs.microsoft.com/azure/active-directory/develop/active-directory-v2-protocols#endpoints).</span><span class="sxs-lookup"><span data-stu-id="8ce04-p107">The `{tenant}` value in the path of the request can be used to control who can sign into the application.  The allowed values are `common` for both Microsoft accounts and work or school accounts, `organizations` for work or school accounts only, `consumers` for Microsoft accounts only, and tenant identifiers such as the tenant ID or domain name.  For more detail, see [protocol basics](https://docs.microsoft.com/azure/active-directory/develop/active-directory-v2-protocols#endpoints).</span></span> |
| <span data-ttu-id="8ce04-140">client_id</span><span class="sxs-lookup"><span data-stu-id="8ce04-140">client_id</span></span> |<span data-ttu-id="8ce04-141">necesario</span><span class="sxs-lookup"><span data-stu-id="8ce04-141">required</span></span> |<span data-ttu-id="8ce04-142">El id. de aplicación que el portal de registro ([apps.dev.microsoft.com](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList)) asignó a la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8ce04-142">The Application ID that the registration portal ([apps.dev.microsoft.com](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList)) assigned your app.</span></span> |
| <span data-ttu-id="8ce04-143">response_type</span><span class="sxs-lookup"><span data-stu-id="8ce04-143">response_type</span></span> |<span data-ttu-id="8ce04-144">necesario</span><span class="sxs-lookup"><span data-stu-id="8ce04-144">required</span></span> |<span data-ttu-id="8ce04-145">Debe incluir `code` para el flujo del código de autorización.</span><span class="sxs-lookup"><span data-stu-id="8ce04-145">Must include `code` for the authorization code flow.</span></span> |
| <span data-ttu-id="8ce04-146">redirect_uri</span><span class="sxs-lookup"><span data-stu-id="8ce04-146">redirect_uri</span></span> |<span data-ttu-id="8ce04-147">recomendado</span><span class="sxs-lookup"><span data-stu-id="8ce04-147">recommended</span></span> |<span data-ttu-id="8ce04-p108">URI de redireccionamiento de la aplicación, donde la aplicación puede enviar y recibir respuestas de autenticación.  Debe coincidir exactamente con uno de los URI de redireccionamiento que ha registrado en el portal de registro de la aplicación, pero con codificación URL.  En el caso de las aplicaciones nativas y móviles, debe usar el valor predeterminado de `https://login.microsoftonline.com/common/oauth2/nativeclient`.</span><span class="sxs-lookup"><span data-stu-id="8ce04-p108">The redirect_uri of your app, where authentication responses can be sent and received by your app.  It must exactly match one of the redirect_uris you registered in the app registration portal, except it must be URL encoded.  For native and mobile apps, you should use the default value of `https://login.microsoftonline.com/common/oauth2/nativeclient`.</span></span> |
| <span data-ttu-id="8ce04-151">ámbito</span><span class="sxs-lookup"><span data-stu-id="8ce04-151">scope</span></span> |<span data-ttu-id="8ce04-152">necesario</span><span class="sxs-lookup"><span data-stu-id="8ce04-152">required</span></span> |<span data-ttu-id="8ce04-p109">Lista separada por espacios de los permisos de Microsoft Graph para los que quiere que el usuario dé su consentimiento. También se pueden incluir ámbitos de OpenID.</span><span class="sxs-lookup"><span data-stu-id="8ce04-p109">A space-separated list of the Microsoft Graph permissions that you want the user to consent to. This may also include OpenID scopes.</span></span> |
| <span data-ttu-id="8ce04-155">response_mode</span><span class="sxs-lookup"><span data-stu-id="8ce04-155">response_mode</span></span> |<span data-ttu-id="8ce04-156">recomendado</span><span class="sxs-lookup"><span data-stu-id="8ce04-156">recommended</span></span> |<span data-ttu-id="8ce04-p110">Especifica el método que se debe usar para enviar el token resultante de vuelta a la aplicación.  Puede ser `query` o `form_post`.</span><span class="sxs-lookup"><span data-stu-id="8ce04-p110">Specifies the method that should be used to send the resulting token back to your app.  Can be `query` or `form_post`.</span></span> |
| <span data-ttu-id="8ce04-159">estado</span><span class="sxs-lookup"><span data-stu-id="8ce04-159">state</span></span> |<span data-ttu-id="8ce04-160">recomendado</span><span class="sxs-lookup"><span data-stu-id="8ce04-160">recommended</span></span> |<span data-ttu-id="8ce04-p111">Valor incluido en la solicitud que también se devolverá en la respuesta de token.  Puede ser una cadena con cualquier contenido que quiera.  Normalmente se usa un valor único generado de forma aleatoria para [impedir los ataques de falsificación de solicitud entre sitios](http://tools.ietf.org/html/rfc6749#section-10.12).  El estado también se usa para codificar la información sobre el estado del usuario en la aplicación antes de que se produjese la solicitud de autenticación, como la página o la visualización en la que estaba.</span><span class="sxs-lookup"><span data-stu-id="8ce04-p111">A value included in the request that will also be returned in the token response.  It can be a string of any content that you wish.  A randomly generated unique value is typically used for [preventing cross-site request forgery attacks](http://tools.ietf.org/html/rfc6749#section-10.12).  The state is also used to encode information about the user's state in the app before the authentication request occurred, such as the page or view they were on.</span></span> |

> <span data-ttu-id="8ce04-p112">**Importante**: Microsoft Graph expone dos tipos de permisos: de aplicación y delegados. En el caso de las aplicaciones que se ejecutan con un usuario que ha iniciado sesión, los permisos delegados se solicitan en el parámetro `scope`. Estos permisos delegan en la aplicación los privilegios del usuario que ha iniciado sesión, lo que permite que la aplicación actúe como dicho usuario al hacer llamadas a Microsoft Graph. Para obtener más información sobre los permisos disponibles mediante Microsoft Graph, vea la [Referencia de permisos](./permissions_reference.md).</span><span class="sxs-lookup"><span data-stu-id="8ce04-p112">**Important**: Microsoft Graph exposes two kinds of permissions: application and delegated. For apps that run with a signed-in user, you request delegated permissions in the `scope` parameter. These permissions delegate the privileges of the signed-in user to your app, allowing it to act as the signed-in user when making calls to Microsoft Graph. For more detailed information about the permissions available through Microsoft Graph, see the [Permissions reference](./permissions_reference.md).</span></span>
 
### <a name="consent-experience"></a><span data-ttu-id="8ce04-169">Experiencia de consentimiento</span><span class="sxs-lookup"><span data-stu-id="8ce04-169">Consent experience</span></span>

<span data-ttu-id="8ce04-p113">En este punto, se pedirá al usuario que escriba sus credenciales para autenticarse con Azure AD. El punto de conexión de v2.0 también se asegurará de que el usuario haya aceptado los permisos indicados en el parámetro de consulta `scope`.  Si el usuario no ha aceptado alguno de estos permisos y si un administrador no ha dado su consentimiento en nombre de todos los usuarios de la organización, Azure AD le pedirá al usuario que dé su consentimiento a los permisos necesarios.</span><span class="sxs-lookup"><span data-stu-id="8ce04-p113">At this point, the user will be asked to enter their credentials to authenticate with Azure AD. The v2.0 endpoint will also ensure that the user has consented to the permissions indicated in the `scope` query parameter.  If the user has not consented to any of those permissions and if an administrator has not previously consented on behalf of all users in the organization, Azure AD will ask the user to consent to the required permissions.</span></span>  

<span data-ttu-id="8ce04-173">A continuación se muestra un ejemplo del cuadro de diálogo de consentimiento que aparece en una cuenta de Microsoft:</span><span class="sxs-lookup"><span data-stu-id="8ce04-173">Here is an example of the consent dialog presented for a Microsoft account:</span></span>

![Cuadro de diálogo de consentimiento para una cuenta de Microsoft](./images/v2-consumer-consent.png)

> <span data-ttu-id="8ce04-p114">**Probar** Si tiene una cuenta de Microsoft o una cuenta profesional o educativa de Azure AD, puede probarlo usted mismo si hace clic en el vínculo siguiente. Después de iniciar sesión, el explorador debería redirigirse a `https://localhost/myapp/` con un `code` en la barra de direcciones.</span><span class="sxs-lookup"><span data-stu-id="8ce04-p114">**Try** If you have a Microsoft account or an Azure AD work or school account, you can try this for yourself by clicking on the link below. After signing in, your browser should be redirected to `https://localhost/myapp/` with a `code` in the address bar.</span></span>
> 
> <span data-ttu-id="8ce04-177"><a href="https://login.microsoftonline.com/common/oauth2/v2.0/authorize?client_id=6731de76-14a6-49ae-97bc-6eba6914391e&response_type=code&redirect_uri=http%3A%2F%2Flocalhost%2Fmyapp%2F&response_mode=query&scope=offline_access%20user.read%20mail.read&state=12345" target="_blank">https://login.microsoftonline.com/common/oauth2/v2.0/authorize...</a></span><span class="sxs-lookup"><span data-stu-id="8ce04-177"><a href="https://login.microsoftonline.com/common/oauth2/v2.0/authorize?client_id=6731de76-14a6-49ae-97bc-6eba6914391e&response_type=code&redirect_uri=http%3A%2F%2Flocalhost%2Fmyapp%2F&response_mode=query&scope=offline_access%20user.read%20mail.read&state=12345" target="_blank">https://login.microsoftonline.com/common/oauth2/v2.0/authorize...</a></span></span>

### <a name="authorization-response"></a><span data-ttu-id="8ce04-178">Respuesta de autorización</span><span class="sxs-lookup"><span data-stu-id="8ce04-178">Authorization response</span></span>
<span data-ttu-id="8ce04-p115">Si el usuario acepta los permisos que ha solicitado la aplicación, la respuesta contendrá el código de autorización en el parámetro `code`. A continuación se muestra un ejemplo de una respuesta correcta a la solicitud anterior. Dado que el parámetro `response_mode` de la solicitud estaba establecido en `query`, la respuesta se devuelve en la cadena de consulta de la dirección URL de redireccionamiento.</span><span class="sxs-lookup"><span data-stu-id="8ce04-p115">If the user consents to the permissions your app requested, the response will contain the authorization code in the `code` parameter. Here is an example of a successful response to the request above. Because the `response_mode` parameter in the request was set to `query`, the response is returned in the query string of the redirect URL.</span></span>

```
GET http://localhost/myapp/?
code=M0ab92efe-b6fd-df08-87dc-2c6500a7f84d
&state=12345
```
| <span data-ttu-id="8ce04-182">Parámetro</span><span class="sxs-lookup"><span data-stu-id="8ce04-182">Parameter</span></span> | <span data-ttu-id="8ce04-183">Descripción</span><span class="sxs-lookup"><span data-stu-id="8ce04-183">Description</span></span> |
| --- | --- |
| <span data-ttu-id="8ce04-184">código</span><span class="sxs-lookup"><span data-stu-id="8ce04-184">code</span></span> |<span data-ttu-id="8ce04-p116">Código de autorización solicitado por la aplicación. La aplicación puede usar el código de autorización para solicitar un token de acceso para el recurso de destino.  Los códigos de autorización duran muy poco. Por lo general, expiran al cabo de 10 minutos.</span><span class="sxs-lookup"><span data-stu-id="8ce04-p116">The authorization_code that the app requested. The app can use the authorization code to request an access token for the target resource.  Authorization_codes are very short lived, typically they expire after about 10 minutes.</span></span> |
| <span data-ttu-id="8ce04-188">estado</span><span class="sxs-lookup"><span data-stu-id="8ce04-188">state</span></span> |<span data-ttu-id="8ce04-p117">Si se incluye un parámetro de estado en la solicitud, debe aparecer el mismo valor en la respuesta. La aplicación debe comprobar que los valores de estado de la solicitud y la respuesta son idénticos.</span><span class="sxs-lookup"><span data-stu-id="8ce04-p117">If a state parameter is included in the request, the same value should appear in the response. The app should verify that the state values in the request and response are identical.</span></span> |

## <a name="3-get-a-token"></a><span data-ttu-id="8ce04-191">3. Obtener un token</span><span class="sxs-lookup"><span data-stu-id="8ce04-191">3. Get a token</span></span>
<span data-ttu-id="8ce04-192">La aplicación usa la autorización `code` recibida en el paso anterior para solicitar un token de acceso mediante el envío de una solicitud `POST` al punto de conexión `/token`.</span><span class="sxs-lookup"><span data-stu-id="8ce04-192">Your app uses the authorization `code` received in the previous step to request an access token by sending a `POST` request to the `/token` endpoint.</span></span>

### <a name="token-request"></a><span data-ttu-id="8ce04-193">Solicitud de token</span><span class="sxs-lookup"><span data-stu-id="8ce04-193">Token request</span></span>
```
// Line breaks for legibility only

POST /common/oauth2/v2.0/token HTTP/1.1
Host: https://login.microsoftonline.com
Content-Type: application/x-www-form-urlencoded

client_id=6731de76-14a6-49ae-97bc-6eba6914391e
&scope=user.read%20mail.read
&code=OAAABAAAAiL9Kn2Z27UubvWFPbm0gLWQJVzCTE9UkP3pSx1aXxUjq3n8b2JRLk4OxVXr...
&redirect_uri=http%3A%2F%2Flocalhost%2Fmyapp%2F
&grant_type=authorization_code
&client_secret=JqQX2PNo9bpM0uEihUPzyrh    // NOTE: Only required for web apps
```

| <span data-ttu-id="8ce04-194">Parámetro</span><span class="sxs-lookup"><span data-stu-id="8ce04-194">Parameter</span></span> |  | <span data-ttu-id="8ce04-195">Descripción</span><span class="sxs-lookup"><span data-stu-id="8ce04-195">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="8ce04-196">tenant</span><span class="sxs-lookup"><span data-stu-id="8ce04-196">tenant</span></span> |<span data-ttu-id="8ce04-197">necesario</span><span class="sxs-lookup"><span data-stu-id="8ce04-197">required</span></span> |<span data-ttu-id="8ce04-p118">Se puede usar el valor `{tenant}` de la ruta de acceso de la solicitud para controlar quién puede iniciar sesión en la aplicación.  Los valores permitidos son `common` para cuentas de Microsoft y cuentas profesionales o educativas, `organizations` solo para cuentas profesionales o educativas, `consumers` solo para cuentas de Microsoft, e identificadores de inquilino como el ID de inquilino o el nombre de dominio.  Para obtener más información, vea los [conceptos básicos de protocolo](https://docs.microsoft.com/azure/active-directory/develop/active-directory-v2-protocols#endpoints).</span><span class="sxs-lookup"><span data-stu-id="8ce04-p118">The `{tenant}` value in the path of the request can be used to control who can sign into the application.  The allowed values are `common` for both Microsoft accounts and work or school accounts, `organizations` for work or school accounts only, `consumers` for Microsoft accounts only, and tenant identifiers such as the tenant ID or domain name.  For more detail, see [protocol basics](https://docs.microsoft.com/azure/active-directory/develop/active-directory-v2-protocols#endpoints).</span></span> |
| <span data-ttu-id="8ce04-201">client_id</span><span class="sxs-lookup"><span data-stu-id="8ce04-201">client_id</span></span> |<span data-ttu-id="8ce04-202">necesario</span><span class="sxs-lookup"><span data-stu-id="8ce04-202">required</span></span> |<span data-ttu-id="8ce04-203">El id. de aplicación que el portal de registro ([apps.dev.microsoft.com](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList)) asignó a la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8ce04-203">The Application ID that the registration portal ([apps.dev.microsoft.com](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList)) assigned your app.</span></span> |
| <span data-ttu-id="8ce04-204">grant_type</span><span class="sxs-lookup"><span data-stu-id="8ce04-204">grant_type</span></span> |<span data-ttu-id="8ce04-205">necesario</span><span class="sxs-lookup"><span data-stu-id="8ce04-205">required</span></span> |<span data-ttu-id="8ce04-206">Debe ser `authorization_code` para el flujo del código de autorización.</span><span class="sxs-lookup"><span data-stu-id="8ce04-206">Must be `authorization_code` for the authorization code flow.</span></span> |
| <span data-ttu-id="8ce04-207">scope</span><span class="sxs-lookup"><span data-stu-id="8ce04-207">scope</span></span> |<span data-ttu-id="8ce04-208">necesario</span><span class="sxs-lookup"><span data-stu-id="8ce04-208">required</span></span> |<span data-ttu-id="8ce04-p119">Lista de ámbitos separados por espacios.  Los ámbitos solicitados en esta sección deben ser equivalentes a los ámbitos solicitados en la primera sección (autorización) o deben ser un subconjunto de estos.  Si los ámbitos especificados en esta solicitud abarcan varios servidores de recursos, el punto de conexión de v2.0 devolverá un token para el recurso especificado en el primer ámbito.</span><span class="sxs-lookup"><span data-stu-id="8ce04-p119">A space-separated list of scopes.  The scopes requested in this leg must be equivalent to or a subset of the scopes requested in the first (authorization) leg.  If the scopes specified in this request span multiple resource servers, then the v2.0 endpoint will return a token for the resource specified in the first scope.</span></span> |
| <span data-ttu-id="8ce04-212">código</span><span class="sxs-lookup"><span data-stu-id="8ce04-212">code</span></span> |<span data-ttu-id="8ce04-213">necesario</span><span class="sxs-lookup"><span data-stu-id="8ce04-213">required</span></span> |<span data-ttu-id="8ce04-214">Código de autorización adquirido en la primera sección del flujo.</span><span class="sxs-lookup"><span data-stu-id="8ce04-214">The authorization_code that you acquired in the first leg of the flow.</span></span> |
| <span data-ttu-id="8ce04-215">redirect_uri</span><span class="sxs-lookup"><span data-stu-id="8ce04-215">redirect_uri</span></span> |<span data-ttu-id="8ce04-216">necesario</span><span class="sxs-lookup"><span data-stu-id="8ce04-216">required</span></span> |<span data-ttu-id="8ce04-217">Mismo valor del URI de redireccionamiento que se usó para adquirir el código de autorización.</span><span class="sxs-lookup"><span data-stu-id="8ce04-217">The same redirect_uri value that was used to acquire the authorization_code.</span></span> |
| <span data-ttu-id="8ce04-218">client_secret</span><span class="sxs-lookup"><span data-stu-id="8ce04-218">client_secret</span></span> |<span data-ttu-id="8ce04-219">necesario para aplicaciones web</span><span class="sxs-lookup"><span data-stu-id="8ce04-219">required for web apps</span></span> |<span data-ttu-id="8ce04-p120">Secreto de la aplicación creado en el portal de registro de la aplicación.  No se debe usar en una aplicación nativa, ya que los secretos de cliente no se pueden almacenar de forma confiable en los dispositivos.  Es necesario para aplicaciones web y API web, que pueden almacenar de forma segura el secreto de cliente en el lado servidor.</span><span class="sxs-lookup"><span data-stu-id="8ce04-p120">The application secret that you created in the app registration portal for your app.  It should not be used in a native app, because client_secrets cannot be reliably stored on devices.  It is required for web apps and web APIs, which have the ability to store the client_secret securely on the server side.</span></span> |

### <a name="token-response"></a><span data-ttu-id="8ce04-223">Respuesta de token</span><span class="sxs-lookup"><span data-stu-id="8ce04-223">Token response</span></span>
<span data-ttu-id="8ce04-224">Aunque el token de acceso es opaco para la aplicación, la respuesta contiene una lista de los permisos para los que el token de acceso es válido en el parámetro `scope`.</span><span class="sxs-lookup"><span data-stu-id="8ce04-224">Although the access token is opaque to your app, the response contains a list of the permissions that the access token is good for in the `scope` parameter.</span></span> 

```
{
    "token_type": "Bearer",
    "scope": "user.read%20Fmail.read",
    "expires_in": 3600,
    "access_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...",
    "refresh_token": "AwABAAAAvPM1KaPlrEqdFSBzjqfTGAMxZGUTdM0t4B4..."
}
```
| <span data-ttu-id="8ce04-225">Parámetro</span><span class="sxs-lookup"><span data-stu-id="8ce04-225">Parameter</span></span> | <span data-ttu-id="8ce04-226">Descripción</span><span class="sxs-lookup"><span data-stu-id="8ce04-226">Description</span></span> |
| --- | --- |
| <span data-ttu-id="8ce04-227">token_type</span><span class="sxs-lookup"><span data-stu-id="8ce04-227">token_type</span></span> |<span data-ttu-id="8ce04-p121">Indica el valor de tipo del token. El único tipo que Azure AD admite es Bearer.</span><span class="sxs-lookup"><span data-stu-id="8ce04-p121">Indicates the token type value. The only type that Azure AD supports is Bearer</span></span> |
| <span data-ttu-id="8ce04-230">ámbito</span><span class="sxs-lookup"><span data-stu-id="8ce04-230">scope</span></span> |<span data-ttu-id="8ce04-231">Lista separada por espacios de los permisos de Microsoft Graph para los que es válido el token de acceso.</span><span class="sxs-lookup"><span data-stu-id="8ce04-231">A space separated list of the Microsoft Graph permissions that the access_token is valid for.</span></span> |
| <span data-ttu-id="8ce04-232">expires_in</span><span class="sxs-lookup"><span data-stu-id="8ce04-232">expires_in</span></span> |<span data-ttu-id="8ce04-233">Período de validez del token de acceso (en segundos).</span><span class="sxs-lookup"><span data-stu-id="8ce04-233">How long the access token is valid (in seconds).</span></span> |
| <span data-ttu-id="8ce04-234">access_token</span><span class="sxs-lookup"><span data-stu-id="8ce04-234">access_token</span></span> |<span data-ttu-id="8ce04-p122">Token de acceso solicitado. La aplicación puede usar este token para llamar a Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="8ce04-p122">The requested access token. Your app can use this token to call Microsoft Graph.</span></span> |
| <span data-ttu-id="8ce04-237">refresh_token</span><span class="sxs-lookup"><span data-stu-id="8ce04-237">refresh_token</span></span> |<span data-ttu-id="8ce04-238">Un token de actualización de OAuth 2.0.</span><span class="sxs-lookup"><span data-stu-id="8ce04-238">An OAuth 2.0 refresh token.</span></span> <span data-ttu-id="8ce04-239">Cuando expire el token de acceso actual, la aplicación puede usar este token para obtener otros tokens de acceso.</span><span class="sxs-lookup"><span data-stu-id="8ce04-239">Your app can use this token to acquire additional access tokens after the current access token expires.</span></span>  <span data-ttu-id="8ce04-240">Los tokens de actualización son de larga duración y se pueden usar para mantener el acceso a los recursos durante períodos prolongados.</span><span class="sxs-lookup"><span data-stu-id="8ce04-240">Refresh tokens are long-lived, and can be used to retain access to resources for extended periods of time.</span></span>  <span data-ttu-id="8ce04-241">Para obtener más información, vea la [Referencia de tokens v2.0](https://docs.microsoft.com/azure/active-directory/develop/active-directory-v2-tokens).</span><span class="sxs-lookup"><span data-stu-id="8ce04-241">For more detail, refer to the [v2.0 token reference](https://docs.microsoft.com/azure/active-directory/develop/active-directory-v2-tokens).</span></span> |

## <a name="4-use-the-access-token-to-call-microsoft-graph"></a><span data-ttu-id="8ce04-242">4. Usar el token de acceso para llamar a Microsoft Graph</span><span class="sxs-lookup"><span data-stu-id="8ce04-242">4. Use the access token to call Microsoft Graph</span></span>

<span data-ttu-id="8ce04-p124">Una vez que tenga un token de acceso, puede usarlo para llamar a Microsoft Graph. Para ello, inclúyalo en el encabezado `Authorization` de una solicitud. Mediante la solicitud siguiente se obtiene el perfil del usuario que ha iniciado sesión.</span><span class="sxs-lookup"><span data-stu-id="8ce04-p124">Once you have an access token, you can use it to call Microsoft Graph by including it in the `Authorization` header of a request. The following request gets the profile of the signed-in user.</span></span>

```
GET https://graph.microsoft.com/v1.0/me 
Authorization: Bearer eyJ0eXAiO ... 0X2tnSQLEANnSPHY0gKcgw
Host: graph.microsoft.com

```
<span data-ttu-id="8ce04-245">Una respuesta correcta tendrá un aspecto similar al siguiente (se han quitado algunos encabezados de respuesta):</span><span class="sxs-lookup"><span data-stu-id="8ce04-245">A successful response will look similar to this (some response headers have been removed):</span></span>

```
HTTP/1.1 200 OK
Content-Type: application/json;odata.metadata=minimal;odata.streaming=true;IEEE754Compatible=false;charset=utf-8
request-id: f45d08c0-6901-473a-90f5-7867287de97f
client-request-id: f45d08c0-6901-473a-90f5-7867287de97f
OData-Version: 4.0
Duration: 727.0022
Date: Thu, 20 Apr 2017 05:21:18 GMT
Content-Length: 407

{
    "@odata.context":"https://graph.microsoft.com/v1.0/$metadata#users/$entity",
    "id":"12345678-73a6-4952-a53a-e9916737ff7f",
    "businessPhones":[
        "+1 555555555"
    ],
    "displayName":"Chris Green",
    "givenName":"Chris",
    "jobTitle":"Software Engineer",
    "mail":null,
    "mobilePhone":"+1 5555555555",
    "officeLocation":"Seattle Office",
    "preferredLanguage":null,
    "surname":"Green",
    "userPrincipalName":"ChrisG@contoso.onmicrosoft.com"
}
```

## <a name="5-use-the-refresh-token-to-get-a-new-access-token"></a><span data-ttu-id="8ce04-246">5. Usar el token de actualización para obtener un nuevo token de acceso</span><span class="sxs-lookup"><span data-stu-id="8ce04-246">5. Use the refresh token to get a new access token</span></span>

<span data-ttu-id="8ce04-p125">Los tokens de acceso tienen una duración breve y deberá actualizarlos una vez que hayan expirado para seguir teniendo acceso a los recursos.  Para ello, envíe otra solicitud `POST` al punto de conexión `/token`, pero esta vez proporcione el `refresh_token` en lugar del `code`.</span><span class="sxs-lookup"><span data-stu-id="8ce04-p125">Access tokens are short lived, and you must refresh them after they expire to continue accessing resources.  You can do so by submitting another `POST` request to the `/token` endpoint, this time providing the `refresh_token` instead of the `code`.</span></span>

### <a name="request"></a><span data-ttu-id="8ce04-249">Solicitud</span><span class="sxs-lookup"><span data-stu-id="8ce04-249">Request</span></span>
```
// Line breaks for legibility only

POST /common/oauth2/v2.0/token HTTP/1.1
Host: https://login.microsoftonline.com
Content-Type: application/x-www-form-urlencoded

client_id=6731de76-14a6-49ae-97bc-6eba6914391e
&scope=user.read%20mail.read
&refresh_token=OAAABAAAAiL9Kn2Z27UubvWFPbm0gLWQJVzCTE9UkP3pSx1aXxUjq...
&redirect_uri=http%3A%2F%2Flocalhost%2Fmyapp%2F
&grant_type=refresh_token
&client_secret=JqQX2PNo9bpM0uEihUPzyrh      // NOTE: Only required for web apps
```

| <span data-ttu-id="8ce04-250">Parámetro</span><span class="sxs-lookup"><span data-stu-id="8ce04-250">Parameter</span></span> |  | <span data-ttu-id="8ce04-251">Descripción</span><span class="sxs-lookup"><span data-stu-id="8ce04-251">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="8ce04-252">client_id</span><span class="sxs-lookup"><span data-stu-id="8ce04-252">client_id</span></span> |<span data-ttu-id="8ce04-253">necesario</span><span class="sxs-lookup"><span data-stu-id="8ce04-253">required</span></span> |<span data-ttu-id="8ce04-254">El id. de aplicación que el portal de registro ([apps.dev.microsoft.com](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList)) asignó a la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8ce04-254">The Application ID that the registration portal ([apps.dev.microsoft.com](https://apps.dev.microsoft.com/?referrer=https://azure.microsoft.com/documentation/articles&deeplink=/appList)) assigned your app.</span></span> |
| <span data-ttu-id="8ce04-255">grant_type</span><span class="sxs-lookup"><span data-stu-id="8ce04-255">grant_type</span></span> |<span data-ttu-id="8ce04-256">necesario</span><span class="sxs-lookup"><span data-stu-id="8ce04-256">required</span></span> |<span data-ttu-id="8ce04-257">Debe ser `refresh_token`.</span><span class="sxs-lookup"><span data-stu-id="8ce04-257">Must be `refresh_token`.</span></span> |
| <span data-ttu-id="8ce04-258">scope</span><span class="sxs-lookup"><span data-stu-id="8ce04-258">scope</span></span> |<span data-ttu-id="8ce04-259">necesario</span><span class="sxs-lookup"><span data-stu-id="8ce04-259">required</span></span> |<span data-ttu-id="8ce04-p126">Lista de permisos (ámbitos) separados por espacios.  Los permisos solicitados deben ser equivalente a los permisos solicitados en la solicitud del código de autorización original o deben ser un subconjunto de estos.</span><span class="sxs-lookup"><span data-stu-id="8ce04-p126">A space-separated list of permissions (scopes).  The permissions requested must be equivalent to or a subset of the permissions requested in the original authorization_code request.</span></span> |
| <span data-ttu-id="8ce04-262">refresh_token</span><span class="sxs-lookup"><span data-stu-id="8ce04-262">refresh_token</span></span> |<span data-ttu-id="8ce04-263">necesario</span><span class="sxs-lookup"><span data-stu-id="8ce04-263">required</span></span> |<span data-ttu-id="8ce04-264">Token de actualización adquirido durante la solicitud de token.</span><span class="sxs-lookup"><span data-stu-id="8ce04-264">The refresh_token that you acquired during the token request.</span></span> |
| <span data-ttu-id="8ce04-265">redirect_uri</span><span class="sxs-lookup"><span data-stu-id="8ce04-265">redirect_uri</span></span> |<span data-ttu-id="8ce04-266">necesario</span><span class="sxs-lookup"><span data-stu-id="8ce04-266">required</span></span> |<span data-ttu-id="8ce04-267">Mismo valor del URI de redireccionamiento que se usó para adquirir el código de autorización.</span><span class="sxs-lookup"><span data-stu-id="8ce04-267">The same redirect_uri value that was used to acquire the authorization_code.</span></span> |
| <span data-ttu-id="8ce04-268">client_secret</span><span class="sxs-lookup"><span data-stu-id="8ce04-268">client_secret</span></span> |<span data-ttu-id="8ce04-269">necesario para aplicaciones web</span><span class="sxs-lookup"><span data-stu-id="8ce04-269">required for web apps</span></span> |<span data-ttu-id="8ce04-p127">Secreto de la aplicación creado en el portal de registro de la aplicación.  No se debe usar en una aplicación nativa, ya que los secretos de cliente no se pueden almacenar de forma confiable en los dispositivos.  Es necesario para aplicaciones web y API web, que pueden almacenar de forma segura el secreto de cliente en el lado servidor.</span><span class="sxs-lookup"><span data-stu-id="8ce04-p127">The application secret that you created in the app registration portal for your app.  It should not be used in a native app, because client_secrets cannot be reliably stored on devices.  It is required for web apps and web APIs, which have the ability to store the client_secret securely on the server side.</span></span> |

### <a name="response"></a><span data-ttu-id="8ce04-273">Respuesta</span><span class="sxs-lookup"><span data-stu-id="8ce04-273">Response</span></span>
<span data-ttu-id="8ce04-274">Una respuesta de token correcta tendrá un aspecto similar al siguiente.</span><span class="sxs-lookup"><span data-stu-id="8ce04-274">A successful token response will look similar to the following.</span></span>

```
{
    "access_token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6Ik5HVEZ2ZEstZnl0aEV1Q...",
    "token_type": "Bearer",
    "expires_in": 3599,
    "scope": "user.read%20mail.read",
    "refresh_token": "AwABAAAAvPM1KaPlrEqdFSBzjqfTGAMxZGUTdM0t4B4...",
}
```
| <span data-ttu-id="8ce04-275">Parámetro</span><span class="sxs-lookup"><span data-stu-id="8ce04-275">Parameter</span></span> | <span data-ttu-id="8ce04-276">Descripción</span><span class="sxs-lookup"><span data-stu-id="8ce04-276">Description</span></span> |
| --- | --- |
| <span data-ttu-id="8ce04-277">access_token</span><span class="sxs-lookup"><span data-stu-id="8ce04-277">access_token</span></span> |<span data-ttu-id="8ce04-p128">Token de acceso solicitado. La aplicación puede usar este token en las llamadas a Microsoft Graph.</span><span class="sxs-lookup"><span data-stu-id="8ce04-p128">The requested access token. The app can use this token in calls to Microsoft Graph.</span></span> |
| <span data-ttu-id="8ce04-280">token_type</span><span class="sxs-lookup"><span data-stu-id="8ce04-280">token_type</span></span> |<span data-ttu-id="8ce04-p129">Indica el valor de tipo del token. El único tipo que Azure AD admite es Bearer.</span><span class="sxs-lookup"><span data-stu-id="8ce04-p129">Indicates the token type value. The only type that Azure AD supports is Bearer</span></span> |
| <span data-ttu-id="8ce04-283">expires_in</span><span class="sxs-lookup"><span data-stu-id="8ce04-283">expires_in</span></span> |<span data-ttu-id="8ce04-284">Período de validez del token de acceso (en segundos).</span><span class="sxs-lookup"><span data-stu-id="8ce04-284">How long the access token is valid (in seconds).</span></span> |
| <span data-ttu-id="8ce04-285">scope</span><span class="sxs-lookup"><span data-stu-id="8ce04-285">scope</span></span> |<span data-ttu-id="8ce04-286">Permisos (ámbitos) para los que es válido el token de acceso.</span><span class="sxs-lookup"><span data-stu-id="8ce04-286">The permissions (scopes) that the access_token is valid for.</span></span> |
| <span data-ttu-id="8ce04-287">refresh_token</span><span class="sxs-lookup"><span data-stu-id="8ce04-287">refresh_token</span></span> |<span data-ttu-id="8ce04-p130">Nuevo token de actualización de OAuth 2.0. Debe reemplazar el token de actualización antiguo por este token de actualización recién adquirido para asegurarse de que los tokens de actualización sigan siendo válidos durante todo el tiempo posible.</span><span class="sxs-lookup"><span data-stu-id="8ce04-p130">A new OAuth 2.0 refresh token. You should replace the old refresh token with this newly acquired refresh token to ensure your refresh tokens remain valid for as long as possible.</span></span> |

## <a name="supported-app-scenarios-and-additional-resources"></a><span data-ttu-id="8ce04-290">Escenarios de aplicación admitidos y recursos adicionales</span><span class="sxs-lookup"><span data-stu-id="8ce04-290">Supported app scenarios and additional resources</span></span>
<span data-ttu-id="8ce04-291">Puede llamar a Microsoft Graph en nombre de un usuario desde los siguientes tipos de aplicaciones:</span><span class="sxs-lookup"><span data-stu-id="8ce04-291">You can call Microsoft Graph on behalf of a user from the following kinds of apps:</span></span> 

- <span data-ttu-id="8ce04-292">Aplicaciones nativas/móviles</span><span class="sxs-lookup"><span data-stu-id="8ce04-292">Native/Mobile apps</span></span> 
- <span data-ttu-id="8ce04-293">Aplicaciones web</span><span class="sxs-lookup"><span data-stu-id="8ce04-293">Web apps</span></span>
- <span data-ttu-id="8ce04-294">Aplicaciones de página única (SPA)</span><span class="sxs-lookup"><span data-stu-id="8ce04-294">Single page apps (SPA)</span></span>
- <span data-ttu-id="8ce04-p131">API web back-end: por ejemplo, en escenarios en los que una aplicación cliente, como una aplicación nativa, implementa una función en el back-end de una API web. Con el punto de conexión de Azure AD v2.0, la aplicación cliente y el back-end de la API web necesitan tener el mismo id. de aplicación.</span><span class="sxs-lookup"><span data-stu-id="8ce04-p131">Back-end Web APIs: For example, in scenarios where a client app, like a native app, implements functionality in a Web API back end. With the Azure AD v2.0 endpoint, both the client app and the back-end Web API must have the same Application ID.</span></span> 

<span data-ttu-id="8ce04-297">Para obtener más información sobre los tipos de aplicaciones compatibles con el punto de conexión de Azure AD v2.0, vea [Tipos de aplicaciones](https://docs.microsoft.com/azure/active-directory/develop/active-directory-v2-flows).</span><span class="sxs-lookup"><span data-stu-id="8ce04-297">For more information about supported app types with the Azure AD v2.0 endpoint, see [Types of apps](https://docs.microsoft.com/azure/active-directory/develop/active-directory-v2-flows).</span></span>

> <span data-ttu-id="8ce04-p132">**Nota**: Actualmente, el punto de conexión de Azure AD v2.0 no permite llamar a Microsoft Graph desde una [API web independiente](https://docs.microsoft.com/azure/active-directory/develop/active-directory-v2-limitations#restrictions-on-app-types). En este caso, debe usar el punto de conexión de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="8ce04-p132">**Note**: Calling Microsoft Graph from a [standalone web API](https://docs.microsoft.com/azure/active-directory/develop/active-directory-v2-limitations#restrictions-on-app-types) is not currently supported by the Azure AD v2.0 endpoint. For this scenario, you need to use the Azure AD endpoint.</span></span>

<span data-ttu-id="8ce04-300">Para obtener más información sobre cómo obtener acceso a Microsoft Graph en nombre de un usuario desde el punto de conexión de Azure AD v2.0:</span><span class="sxs-lookup"><span data-stu-id="8ce04-300">For more information about getting access to Microsoft Graph on behalf of a user from the Azure AD v2.0 endpoint:</span></span>

- <span data-ttu-id="8ce04-301">Para obtener vínculos a documentación de protocolos y a artículos de introducción a los distintos tipos de aplicaciones, vea la [documentación del punto de conexión de Azure AD v2.0](https://docs.microsoft.com/azure/active-directory/develop/active-directory-appmodel-v2-overview).</span><span class="sxs-lookup"><span data-stu-id="8ce04-301">For links to protocol documentation and getting started articles for different kinds of apps, see the [Azure AD v2.0 endpoint documentation](https://docs.microsoft.com/azure/active-directory/develop/active-directory-appmodel-v2-overview).</span></span> 
- <span data-ttu-id="8ce04-302">Para obtener una explicación detallada de los flujos de autenticación, vea [Protocolos de v2.0](https://docs.microsoft.com/azure/active-directory/develop/active-directory-v2-protocols).</span><span class="sxs-lookup"><span data-stu-id="8ce04-302">For detailed explanations of authentication flows, see [v2.0 protocols](https://docs.microsoft.com/azure/active-directory/develop/active-directory-v2-protocols).</span></span>
- <span data-ttu-id="8ce04-303">Para obtener más información sobre el software intermedio de servidor y las bibliotecas de autenticación de Microsoft y de terceros recomendadas para Azure AD v2.0, vea [Bibliotecas de autenticación de Azure Active Directory v2.0](https://docs.microsoft.com/azure/active-directory/develop/active-directory-v2-libraries).</span><span class="sxs-lookup"><span data-stu-id="8ce04-303">For more information about recommended Microsoft and third-party authentication libraries and server middleware for Azure AD v2.0, see [Azure Active Directory v2.0 authentication libraries](https://docs.microsoft.com/azure/active-directory/develop/active-directory-v2-libraries).</span></span>

## <a name="azure-ad-endpoint-considerations"></a><span data-ttu-id="8ce04-304">Consideraciones sobre el punto de conexión de Azure AD</span><span class="sxs-lookup"><span data-stu-id="8ce04-304">Azure AD endpoint considerations</span></span>
<span data-ttu-id="8ce04-p133">Existen varias diferencias entre usar el punto de conexión de Azure AD y el punto de conexión de Azure AD v2.0. Por ejemplo:</span><span class="sxs-lookup"><span data-stu-id="8ce04-p133">There are several differences between using the Azure AD endpoint and the Azure AD v2.0 endpoint. For example:</span></span>

- <span data-ttu-id="8ce04-p134">Para configurar la aplicación, se usa [Azure Portal](https://portal.azure.com). Para obtener más información sobre cómo configurar aplicaciones con Azure Portal, vea [Integración de aplicaciones con Azure Active Directory: Agregar una aplicación](https://docs.microsoft.com/azure/active-directory/develop/active-directory-integrating-applications#adding-an-application).</span><span class="sxs-lookup"><span data-stu-id="8ce04-p134">You use the [Azure portal](https://portal.azure.com) to configure your app. For more information about configuring apps with the Azure portal, see [Integrating applications with Azure Active Directory: Adding an application](https://docs.microsoft.com/azure/active-directory/develop/active-directory-integrating-applications#adding-an-application)</span></span>
- <span data-ttu-id="8ce04-309">La aplicación necesitará un id. de aplicación distinto (id. de cliente) para cada plataforma.</span><span class="sxs-lookup"><span data-stu-id="8ce04-309">Your app will require a different application ID (client ID) for each platform.</span></span>
- <span data-ttu-id="8ce04-310">Si la aplicación es multiinquilino, necesita configurarla de forma explícita para que sea multiinquilino en [Azure Portal](https://portal.azure.com).</span><span class="sxs-lookup"><span data-stu-id="8ce04-310">If your app is a multi-tenant app, you must explicitly configure it to be multi-tenant at the [Azure portal](https://portal.azure.com).</span></span>
- <span data-ttu-id="8ce04-p135">Con el punto de conexión de Azure AD, todos los permisos que necesita la aplicación debe configurarlos el desarrollador. El punto de conexión de Azure AD no admite el consentimiento dinámico (incremental).</span><span class="sxs-lookup"><span data-stu-id="8ce04-p135">With the Azure AD endpoint, all permissions that your app needs must be configured by the developer. The Azure AD endpoint does not support dynamic (incremental) consent.</span></span>
- <span data-ttu-id="8ce04-p136">El punto de conexión de Azure AD usa un parámetro `resource` en las solicitudes de autorización y de token para especificar el recurso, como Microsoft Graph, para el que quiere los permisos. El punto de conexión no admite el parámetro `scope`.</span><span class="sxs-lookup"><span data-stu-id="8ce04-p136">The Azure AD endpoint uses a `resource` parameter in authorization and token requests to specify the resource, such as Microsoft Graph, for which it wants permissions. The endpoint does not support the `scope` parameter.</span></span> 
- <span data-ttu-id="8ce04-p137">El punto de conexión de Azure AD no expone un punto de conexión específico para el consentimiento del administrador. En su lugar, las aplicaciones usan el parámetro `prompt=admin_consent` en la solicitud de autorización para obtener el consentimiento del administrador para una organización. Para obtener más información, vea **Desencadenamiento del marco de consentimiento de Azure AD en tiempo de ejecución** en [Integración de aplicaciones con Azure Active Directory](https://docs.microsoft.com/azure/active-directory/develop/active-directory-integrating-applications).</span><span class="sxs-lookup"><span data-stu-id="8ce04-p137">The Azure AD endpoint does not expose a specific endpoint for administrator consent. Instead apps use the `prompt=admin_consent` parameter in the authorization request to obtain administrator consent for an organization. For more information, see **Triggering the Azure AD consent framework at runtime** in [Integrating applications with Azure Active Directory](https://docs.microsoft.com/azure/active-directory/develop/active-directory-integrating-applications).</span></span>

<span data-ttu-id="8ce04-318">Para obtener más información sobre cómo obtener acceso a Microsoft Graph en nombre de un usuario desde el punto de conexión de Azure AD:</span><span class="sxs-lookup"><span data-stu-id="8ce04-318">For more information about getting access to Microsoft Graph on behalf of a user from the Azure AD endpoint:</span></span>

- <span data-ttu-id="8ce04-p138">Para obtener información sobre cómo usar el punto de conexión de Azure AD con diferentes tipos de aplicaciones, vea los vínculos de **introducción** de la guía de [Azure Active Directory para desarrolladores](https://docs.microsoft.com/azure/active-directory/develop/active-directory-developers-guide). La guía contiene vínculos a temas con información general, tutoriales de código y documentación de protocolos para distintos tipos de aplicaciones admitidas por el punto de conexión de Azure AD.</span><span class="sxs-lookup"><span data-stu-id="8ce04-p138">For information about using the Azure AD endpoint with different kinds of apps, see the **Get Started** links in the [Azure Active Directory developers guide](https://docs.microsoft.com/azure/active-directory/develop/active-directory-developers-guide). The guide contains links to overview topics, code walk-throughs, and protocol documentation for different kinds of app supported by the Azure AD endpoint.</span></span>
- <span data-ttu-id="8ce04-321">Para obtener información sobre la Biblioteca de autenticación de Active Directory (ADAL) y el software intermedio de servidor disponible para su uso con el punto de conexión de Azure AD, vea [Bibliotecas de autenticación de Azure Active Directory](https://docs.microsoft.com/azure/active-directory/develop/active-directory-authentication-libraries).</span><span class="sxs-lookup"><span data-stu-id="8ce04-321">For information about the Active Directory Authentication Library (ADAL) and server middleware available for use with the Azure AD endpoint, see [Azure Active Directory Authentication Libraries](https://docs.microsoft.com/azure/active-directory/develop/active-directory-authentication-libraries).</span></span>

